## Решение
Рассмотрим все листья в нашем графе. 

**Случай 1**. Если некоторый лист имеет двух родителей, тогда необходимо удалить одно из этих ребер. Поскольку удаление самого листа оставляет корректное корневое дерево, то нам не важно, которое из двух ребер удалить. Удалим то, что позже встречалось в edges

**Случай 2**. Если не нашлось ни одного листа из случая 1, удалим все листья и повторим ту же самую логику. Будем повторять так, пока у нас в целом есть листья. Очевидно, что ответ для оставшегося после удалений листьев графа будет ответом и для исходного графа

**Случай 3**. В графе не осталось листьев. Поскольку это все еще корневое дерево, в которое добавили одно ребро, то граф представляет из себя одно из двух:
1) цикл
2) цикл, в который ведет ориентированный бамбук из корня

Эти два представления отличаются друг от друга тем, что во втором есть ровно одна вершина с двумя предками. 

**Случай 3.1** Пусть в графе есть вершина $v$ с двумя предками. Очевидно, надо удалить ребро, ведущее в нее в цикле. Найдем это ребро. Выберем произвольного из предков вершины $v$ - вершину $p$, и поднимемся от него вверх по предкам, пока не окажемся либо в корне, либо снова в $v$. Если мы оказались в корне, то нужно удалить ребро, ведущее из $v$ в другого предка, не в $p$. Если мы оказались в $v$, то удалим ребро ведущее из $p$ в $v$

**Случай 3.2** Достаточно удалить любое ребро. По условию удалим то, что позже встречается в edges


## Время работы
Пусть количество вершин в графе - $N$, количество ребер - $M$.

Первый и второй случаи можно обработать за $O(N + M)$ при помощи очереди. Добавим все листья в очередь. Будем доставать из нее вершины по одной и декрементировать количество ребер, изходящих из предка вершины. Если оказалось, что из предка исходит 0 ребер, то добавим его в очередь. 

Третий случай очевидным образом тоже обрабатывается за линию

Итого все работает за $O(N + M)$