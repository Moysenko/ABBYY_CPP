## Решение
Пусть в графе $N$ вершин и $M$ ребер
Введем три обозначения
* $F$ - вес минимального остова изначального графа
* $W_i$ - вес минимального остова без $i$-го ребра
* $M_i$ - вес минимального остова, если объединить вершины, соедененные $i$-м ребром

Если $W_i > F$, то $i$-е ребро обязательно должно содержаться в остове и является критическим. 

Иначе $W_i = F$, это значит, что существует минимальный остов, в котором $i$-е ребро не содержится. Если $M_i = F$, то найдется минимальный остов, содержащий $i$-е ребро - значит, это ребро псевдокритическое

При подсчитанных $F, W_i, M_i$ проверка условий делается за $O(N)$. Предподсчет $F, W_i, M_i$ делается за $O(M)$ запусков алгоритма Прима, в моей реализации каждый работает за $O(M \cdot \log N)$. Итого асимптотика - $O(M^2 \cdot \log N)$.